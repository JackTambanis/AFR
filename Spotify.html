<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3D Particle Field Cursor</title>
<style>
  body { margin:0; overflow:hidden; background:black; cursor:none; }
  canvas { display:block; }
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
let w = canvas.width = window.innerWidth;
let h = canvas.height = window.innerHeight;

window.addEventListener('resize', ()=>{
  w = canvas.width = window.innerWidth;
  h = canvas.height = window.innerHeight;
});

// Cursor
let cursor = { x: w/2, y: h/2 };
document.addEventListener('mousemove', e=>{
  cursor.x = e.clientX;
  cursor.y = e.clientY;
});

// Particle class
class Particle {
  constructor(x, y, z){
    this.originX = x;
    this.originY = y;
    this.originZ = z; // depth
    this.x = x;
    this.y = y;
    this.z = z;
    this.size = 2 + z*3;
    this.vx = 0;
    this.vy = 0;
  }
  update(){
    // Vector from cursor to particle
    const dx = this.x - cursor.x;
    const dy = this.y - cursor.y;
    const dist = Math.sqrt(dx*dx + dy*dy);
    const radius = 100; // influence radius

    if(dist < radius){
      const force = (radius - dist)/radius*5;
      this.vx += (dx/dist)*force;
      this.vy += (dy/dist)*force;
    }

    // Return to original position slowly
    const homeForce = 0.02;
    this.vx += (this.originX - this.x)*homeForce;
    this.vy += (this.originY - this.y)*homeForce;

    // Apply velocity with damping
    this.vx *= 0.9;
    this.vy *= 0.9;
    this.x += this.vx;
    this.y += this.vy;
  }
  draw(){
    const scale = this.z; // pseudo depth scaling
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size*scale, 0, Math.PI*2);
    ctx.fillStyle = `hsla(${this.z*100}, 80%, 60%, 0.8)`;
    ctx.fill();
  }
}

// Create particle array
const particles = [];
const spacing = 30;
for(let y=spacing/2; y<h; y+=spacing){
  for(let x=spacing/2; x<w; x+=spacing){
    const z = Math.random()*1.5 + 0.5; // depth
    particles.push(new Particle(x, y, z));
  }
}

function animate(){
  ctx.clearRect(0,0,w,h);

  // Draw and update particles sorted by depth
  particles.sort((a,b)=>b.z-a.z);
  particles.forEach(p=>{
    p.update();
    p.draw();
  });

  // Draw cursor
  ctx.beginPath();
  ctx.arc(cursor.x, cursor.y, 10, 0, Math.PI*2);
  ctx.fillStyle = "#fff";
  ctx.fill();

  requestAnimationFrame(animate);
}
animate();
</script>
</body>
</html>
